{"version":3,"sources":["../../src/webgpu/examples.spec.ts"],"names":["description","makeTestGroup","GPUTest","g","test","fn","t","expect","shouldThrow","TypeError","shouldReject","Promise","reject","params","x","y","_result","fence","queue","createFence","signal","onCompletion","getCompletedValue","data","Uint32Array","src","device","createBuffer","mappedAtCreation","size","usage","GPUBufferUsage","COPY_SRC","COPY_DST","getMappedRange","set","unmap","expectContents"],"mappings":";;GAAA,OAAO,MAAMA,WAAW,GAAI;;;;CAArB,CAMP,SAASC,aAAT,QAA8B,mCAA9B;;AAEA,SAASC,OAAT,QAAwB,eAAxB;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA,OAAO,MAAMC,CAAC,GAAGF,aAAa,CAACC,OAAD,CAAvB;;AAEP;;AAEAC,CAAC,CAACC,IAAF,CAAO,WAAP,EAAoBC,EAApB,CAAuBC,CAAC,IAAI,CAAE,CAA9B;;AAEAH,CAAC,CAACC,IAAF,CAAO,OAAP,EAAgBC,EAAhB,CAAmBC,CAAC,IAAI;AACtBA,EAAAA,CAAC,CAACC,MAAF,CAAS,IAAT;AACAD,EAAAA,CAAC,CAACC,MAAF,CAAS,IAAT,EAAe,qBAAf;;AAEAD,EAAAA,CAAC,CAACE,WAAF;AACE;AACA,aAFF;AAGE;AACA,QAAM;AACJ,UAAM,IAAIC,SAAJ,EAAN;AACD,GANH;AAOE;AACA,+BARF;;AAUD,CAdD;;AAgBAN,CAAC,CAACC,IAAF,CAAO,aAAP,EAAsBC,EAAtB,CAAyB,MAAMC,CAAN,IAAW;AAClC;AACAA,EAAAA,CAAC,CAACI,YAAF;AACE;AACA,aAFF;AAGE;AACAC,EAAAA,OAAO,CAACC,MAAR,CAAe,IAAIH,SAAJ,EAAf,CAJF;AAKE;AACA,gCANF;;;AASA;AACAH,EAAAA,CAAC,CAACI,YAAF;AACE,aADF;AAEE,GAAC,YAAY;AACX,UAAM,IAAID,SAAJ,EAAN;AACD,GAFD,GAFF;AAKE,gCALF;;AAOD,CAnBD;;AAqBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACAN,CAAC,CAACC,IAAF,CAAO,cAAP;AACGS,MADH,CACU;AACN,EAAEC,CAAC,EAAE,CAAL,EAAQC,CAAC,EAAE,CAAX,EAAcC,OAAO,EAAE,CAAvB,EADM,EACsB;AAC5B,EAAEF,CAAC,EAAE,CAAC,EAAN,EAAUC,CAAC,EAAE,EAAb,EAAiBC,OAAO,EAAE,CAA1B,EAFM,CADV;;AAKGX,EALH,CAKMC,CAAC,IAAI;AACPA,EAAAA,CAAC,CAACC,MAAF,CAASD,CAAC,CAACO,MAAF,CAASC,CAAT,GAAaR,CAAC,CAACO,MAAF,CAASE,CAAtB,KAA4BT,CAAC,CAACO,MAAF,CAASG,OAA9C;AACD,CAPH;AAQA;;AAEAb,CAAC,CAACC,IAAF,CAAO,WAAP,EAAoBC,EAApB,CAAuB,MAAMC,CAAN,IAAW;AAChC,QAAMW,KAAK,GAAGX,CAAC,CAACY,KAAF,CAAQC,WAAR,EAAd;AACAb,EAAAA,CAAC,CAACY,KAAF,CAAQE,MAAR,CAAeH,KAAf,EAAsB,CAAtB;AACA,QAAMA,KAAK,CAACI,YAAN,CAAmB,CAAnB,CAAN;AACAf,EAAAA,CAAC,CAACC,MAAF,CAASU,KAAK,CAACK,iBAAN,OAA8B,CAAvC;AACD,CALD;;AAOAnB,CAAC,CAACC,IAAF,CAAO,aAAP,EAAsBC,EAAtB,CAAyB,MAAMC,CAAN,IAAW;AAClC,QAAMiB,IAAI,GAAG,IAAIC,WAAJ,CAAgB,CAAC,CAAD,EAAI,IAAJ,EAAU,CAAV,CAAhB,CAAb;AACA,QAAMC,GAAG,GAAGnB,CAAC,CAACoB,MAAF,CAASC,YAAT,CAAsB;AAChCC,IAAAA,gBAAgB,EAAE,IADc;AAEhCC,IAAAA,IAAI,EAAE,EAF0B;AAGhCC,IAAAA,KAAK,EAAEC,cAAc,CAACC,QAAf,GAA0BD,cAAc,CAACE,QAHhB,EAAtB,CAAZ;;AAKA,MAAIT,WAAJ,CAAgBC,GAAG,CAACS,cAAJ,EAAhB,EAAsCC,GAAtC,CAA0CZ,IAA1C;AACAE,EAAAA,GAAG,CAACW,KAAJ;;AAEA;AACA;AACA9B,EAAAA,CAAC,CAAC+B,cAAF,CAAiBZ,GAAjB,EAAsBF,IAAtB;AACD,CAbD","sourcesContent":["export const description = `\nExamples of writing CTS tests with various features.\n\nStart here when looking for examples of basic framework usage.\n`;\n\nimport { makeTestGroup } from '../common/framework/test_group.js';\n\nimport { GPUTest } from './gpu_test.js';\n\n// To run these tests in the standalone runner, run `grunt build` or `grunt pre` then open:\n// - http://localhost:8080/?runnow=1&q=webgpu:examples:\n// To run in WPT, copy/symlink the out-wpt/ directory as the webgpu/ directory in WPT, then open:\n// - (wpt server url)/webgpu/cts.html?q=webgpu:examples:\n//\n// Tests here can be run individually or in groups:\n// - ?q=webgpu:examples:basic/async=\n// - ?q=webgpu:examples:basic/\n// - ?q=webgpu:examples:\n\nexport const g = makeTestGroup(GPUTest);\n\n// Note: spaces in test names are replaced with underscores: webgpu:examples:test_name=\n/* eslint-disable-next-line  @typescript-eslint/no-unused-vars */\ng.test('test_name').fn(t => {});\n\ng.test('basic').fn(t => {\n  t.expect(true);\n  t.expect(true, 'true should be true');\n\n  t.shouldThrow(\n    // The expected '.name' of the thrown error.\n    'TypeError',\n    // This function is run inline inside shouldThrow, and is expected to throw.\n    () => {\n      throw new TypeError();\n    },\n    // Log message.\n    'function should throw Error'\n  );\n});\n\ng.test('basic,async').fn(async t => {\n  // shouldReject must be awaited to ensure it can wait for the promise before the test ends.\n  t.shouldReject(\n    // The expected '.name' of the thrown error.\n    'TypeError',\n    // Promise expected to reject.\n    Promise.reject(new TypeError()),\n    // Log message.\n    'Promise.reject should reject'\n  );\n\n  // Promise can also be an IIFE.\n  t.shouldReject(\n    'TypeError',\n    (async () => {\n      throw new TypeError();\n    })(),\n    'Promise.reject should reject'\n  );\n});\n\n// A test can be parameterized with a simple array of objects.\n//\n// Parameters can be public (x, y) which means they're part of the case name.\n// They can also be private by starting with an underscore (_result), which passes\n// them into the test but does not make them part of the case name:\n//\n// - webgpu:examples:basic/params={\"x\":2,\"y\":4}    runs with t.params = {x: 2, y: 5, _result: 6}.\n// - webgpu:examples:basic/params={\"x\":-10,\"y\":18} runs with t.params = {x: -10, y: 18, _result: 8}.\ng.test('basic,params')\n  .params([\n    { x: 2, y: 4, _result: 6 }, //\n    { x: -10, y: 18, _result: 8 },\n  ])\n  .fn(t => {\n    t.expect(t.params.x + t.params.y === t.params._result);\n  });\n// (note the blank comment above to enforce newlines on autoformat)\n\ng.test('gpu,async').fn(async t => {\n  const fence = t.queue.createFence();\n  t.queue.signal(fence, 2);\n  await fence.onCompletion(1);\n  t.expect(fence.getCompletedValue() === 2);\n});\n\ng.test('gpu,buffers').fn(async t => {\n  const data = new Uint32Array([0, 1234, 0]);\n  const src = t.device.createBuffer({\n    mappedAtCreation: true,\n    size: 12,\n    usage: GPUBufferUsage.COPY_SRC | GPUBufferUsage.COPY_DST,\n  });\n  new Uint32Array(src.getMappedRange()).set(data);\n  src.unmap();\n\n  // Use the expectContents helper to check the actual contents of a GPUBuffer.\n  // Like shouldReject, it must be awaited.\n  t.expectContents(src, data);\n});\n"],"file":"examples.spec.js"}